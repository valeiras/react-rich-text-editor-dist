import{L as B,a as n,b as T,c as ce,r as m,j as i,d as oe,E as ie,$ as Y,s as fe,u as de,e as le,f as be,g as ge}from"./rich-editor-wc.js";var Z={},H={},me=B,Q=n;let K=class ee extends Q.TextNode{static getType(){return"hashtag"}static clone(t){return new ee(t.__text,t.__key)}constructor(t,u){super(t,u)}createDOM(t){let u=super.createDOM(t);return me.addClassNamesToElement(u,t.theme.hashtag),u}static importJSON(t){let u=ue(t.text);return u.setFormat(t.format),u.setDetail(t.detail),u.setMode(t.mode),u.setStyle(t.style),u}exportJSON(){return{...super.exportJSON(),type:"hashtag"}}canInsertTextBefore(){return!1}isTextEntity(){return!0}};function ue(e=""){return Q.$applyNodeReplacement(new K(e))}H.$createHashtagNode=ue;H.$isHashtagNode=function(e){return e instanceof K};H.HashtagNode=K;const he=H;var pe=he,te={},xe=T,Ce=ce,Ee=B,_e=m;te.useLexicalTextEntity=function(e,t,u){let[l]=xe.useLexicalComposerContext();_e.useEffect(()=>Ee.mergeRegister(...Ce.registerLexicalTextEntity(l,e,t,u)),[u,l,e,t])};const Ne=te;var ve=Ne,A=pe,Le=T,we=ve,W=m,ye=RegExp;let S=String.fromCharCode,G="A-Za-zªµºÀ-ÖØ-öø-Ɂɐ-ˁˆ-ˑˠ-ˤˮͺΆΈ-ΊΌΎ-ΡΣ-ώϐ-ϵϷ-ҁҊ-ӎӐ-ӹԀ-ԏԱ-Ֆՙա-ևא-תװ-ײء-غـ-يٮ-ٯٱ-ۓەۥ-ۦۮ-ۯۺ-ۼۿܐܒ-ܯݍ-ݭހ-ޥޱऄ-हऽॐक़-ॡॽঅ-ঌএ-ঐও-নপ-রলশ-হঽৎড়-ঢ়য়-ৡৰ-ৱਅ-ਊਏ-ਐਓ-ਨਪ-ਰਲ-ਲ਼ਵ-ਸ਼ਸ-ਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલ-ળવ-હઽૐૠ-ૡଅ-ଌଏ-ଐଓ-ନପ-ରଲ-ଳଵ-ହଽଡ଼-ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கங-சஜஞ-டண-தந-பம-ஹఅ-ఌఎ-ఐఒ-నప-ళవ-హౠ-ౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠ-ೡഅ-ഌഎ-ഐഒ-നപ-ഹൠ-ൡඅ-ඖක-නඳ-රලව-ෆก-ะา-ำเ-ๆກ-ຂຄງ-ຈຊຍດ-ທນ-ຟມ-ຣລວສ-ຫອ-ະາ-ຳຽເ-ໄໆໜ-ໝༀཀ-ཇཉ-ཪྈ-ྋက-အဣ-ဧဩ-ဪၐ-ၕႠ-Ⴥა-ჺჼᄀ-ᅙᅟ-ᆢᆨ-ᇹሀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙶᚁ-ᚚᚠ-ᛪᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦩᧁ-ᧇᨀ-ᨖᴀ-ᶿḀ-ẛẠ-ỹἀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₔℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℱℳ-ℹℼ-ℿⅅ-ⅉⰀ-Ⱞⰰ-ⱞⲀ-ⳤⴀ-ⴥⴰ-ⵥⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〆〱-〵〻-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄬㄱ-ㆎㆠ-ㆷㇰ-ㇿ㐀-䶵一-龻ꀀ-ꒌꠀ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢ가-힣豈-鶴侮-頻並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ̀-ͯ҃-֑҆-ֹֻ-ֽֿׁ-ׂׄ-ׇׅؐ-ًؕ-ٰٞۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ްँ-ः़ा-्॑-॔ॢ-ॣঁ-ঃ়া-ৄে-ৈো-্ৗৢ-ৣਁ-ਃ਼ਾ-ੂੇ-ੈੋ-੍ੰ-ੱઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣଁ-ଃ଼ା-ୃେ-ୈୋ-୍ୖ-ୗஂா-ூெ-ைொ-்ௗఁ-ఃా-ౄె-ైొ-్ౕ-ౖಂ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕ-ೖം-ഃാ-ൃെ-ൈൊ-്ൗං-ඃ්ා-ුූෘ-ෟෲ-ෳัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-༹༙༵༷༾-༿ཱ-྄྆-྇ྐ-ྗྙ-ྼ࿆ာ-ဲံ-္ၖ-ၙ፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳា-៓៝᠋-᠍ᢩᤠ-ᤫᤰ-᤻ᦰ-ᧀᧈ-ᧉᨗ-ᨛ᷀-᷃⃐-⃥⃜⃡-⃫〪-゙〯-゚ꠂ꠆ꠋꠣ-ꠧﬞ︀-️︠-︣À-ÖØ-öø-ÿĀ-ɏɓ-ɔɖ-ɗəɛɣɨɯɲʉʋʻ̀-ͯḀ-ỿЀ-ӿԀ-ԧⷠ-ⷿꙀ-֑ꚟ-ֿׁ-ׂׄ-ׇׅא-תװ-״﬒-ﬨשׁ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﭏؐ-ؚؠ-ٟٮ-ۓە-ۜ۞-۪ۨ-ۯۺ-ۼۿݐ-ݿࢠࢢ-ࢬࣤ-ࣾﭐ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼ‌-‌ก-ฺเ-๎ᄀ-ᇿ㄰-ㆅꥠ-꥿가-힯ힰ-퟿ﾡ-ￜァ-ヺー-ヾｦ-ﾟ０-９Ａ-Ｚａ-ｚぁ-ゖ゙-ゞ㐀-䶿一-鿿"+(S(173824)+"-"+S(177983)+S(177984)+"-"+S(178207)+S(194560)+"-"+S(195103)+"〃々〻"),{alpha:Me,alphanumeric:ae,hashChars:ze}={alpha:G,alphanumeric:G+"0-9٠-٩۰-۹०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉០-៩᠐-᠙᥆-᥏᧐-᧙０-９_",hashChars:"#\\uFF03"},X="["+ae+"]",Re=new ye("(^|$|[^&/"+(ae+"])([")+(ze+"])(")+X+"*["+(Me+"]")+X+"*)","i");Z.HashtagPlugin=function(){let[e]=Le.useLexicalComposerContext();W.useEffect(()=>{if(!e.hasNodes([A.HashtagNode]))throw Error("HashtagPlugin: HashtagNode not registered on editor")},[e]);let t=W.useCallback(l=>A.$createHashtagNode(l.getTextContent()),[]),u=W.useCallback(l=>{if(l=Re.exec(l),l===null)return null;const v=l.index+l[1].length;return{end:v+(l[3].length+1),start:v}},[]);return we.useLexicalTextEntity(u,A.HashtagNode,t),null};const Pe=Z;var $e=Pe,re={},F={},ne=m;let U=[["Cat","rgb(125, 50, 0)"],["Dog","rgb(100, 0, 0)"],["Rabbit","rgb(150, 0, 0)"],["Frog","rgb(200, 0, 0)"],["Fox","rgb(200, 75, 0)"],["Hedgehog","rgb(0, 75, 0)"],["Pigeon","rgb(0, 125, 0)"],["Squirrel","rgb(75, 100, 0)"],["Bear","rgb(125, 100, 0)"],["Tiger","rgb(0, 0, 150)"],["Leopard","rgb(0, 0, 200)"],["Zebra","rgb(0, 0, 250)"],["Wolf","rgb(0, 100, 150)"],["Owl","rgb(0, 100, 100)"],["Gull","rgb(100, 0, 100)"],["Squid","rgb(150, 0, 150)"]],q=U[Math.floor(Math.random()*U.length)],se=ne.createContext({clientID:0,color:q[1],isCollabActive:!1,name:q[0],yjsDocMap:new Map});F.CollaborationContext=se;F.useCollaborationContext=function(e,t){let u=ne.useContext(se);return e!=null&&(u.name=e),t!=null&&(u.color=t),u};const De=F;var Se=De,Oe=Se,j=T,O=m;function Ie(e){let t=new URLSearchParams;t.append("code",e);for(let u=1;u<arguments.length;u++)t.append("v",arguments[u]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}re.LexicalNestedComposer=function({initialEditor:e,children:t,initialNodes:u,initialTheme:l,skipCollabChecks:v}){let _=O.useRef(!1),L=O.useContext(j.LexicalComposerContext);L==null&&Ie(9);let[w,{getTheme:p}]=L,C=O.useMemo(()=>{var c=l||p()||void 0;const P=j.createLexicalComposerContext(L,c);if(c!==void 0&&(e._config.theme=c),e._parentEditor=w,u)for(var x of u)c=x.getType(),e._nodes.set(c,{klass:x,replace:null,replaceWithKlass:null,transforms:new Set});else{x=e._nodes=new Map(w._nodes);for(const[$,M]of x)e._nodes.set($,{klass:M.klass,replace:M.replace,replaceWithKlass:M.replaceWithKlass,transforms:new Set})}return e._config.namespace=w._config.namespace,e._editable=w._editable,[e,P]},[]),{isCollabActive:E,yjsDocMap:y}=Oe.useCollaborationContext(),z=v||_.current||y.has(e.getKey());return O.useEffect(()=>{z&&(_.current=!0)},[z]),O.useEffect(()=>w.registerEditableListener(c=>{e.setEditable(c)}),[e,w]),O.createElement(j.LexicalComposerContext.Provider,{value:C},!E||z?t:null)};const Te=re;var He=Te;function Ae({className:e}){return i.jsx(oe.ContentEditable,{className:e||"ContentEditable__root"})}function k(e,t,u){return Math.min(Math.max(e,t),u)}const o={east:1,north:8,south:2,west:4};function We({imageRef:e,editor:t,nodeKey:u}){const l=m.useRef(null),v=m.useRef({priority:"",value:"default"}),_=m.useRef({currentHeight:100,currentWidth:100,direction:0,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}),[L,w]=m.useState(0),p=t.getRootElement(),C=p!==null?p.getBoundingClientRect().width-2*ie:100,E=p!==null?p.getBoundingClientRect().height:100,y=100,z=100,c=a=>{const g=a===o.east||a===o.west,b=a===o.north||a===o.south,s=a&o.north&&a&o.west||a&o.south&&a&o.east,N=g?"ew":b?"ns":s?"nwse":"nesw";p!==null&&p.style.setProperty("cursor",`${N}-resize`,"important"),document.body!==null&&(document.body.style.setProperty("cursor",`${N}-resize`,"important"),v.current.value=document.body.style.getPropertyValue("-webkit-user-select"),v.current.priority=document.body.style.getPropertyPriority("-webkit-user-select"),document.body.style.setProperty("-webkit-user-select","none","important"))},P=()=>{p!==null&&p.style.setProperty("cursor","text"),document.body!==null&&(document.body.style.setProperty("cursor","default"),document.body.style.setProperty("-webkit-user-select",v.current.value,v.current.priority))},x=(a,g)=>{var D,R,f;if(!t.isEditable())return;const b=(R=(D=e.current)==null?void 0:D.parentElement)==null?void 0:R.parentElement,s=(f=b==null?void 0:b.parentElement)==null?void 0:f.parentElement;console.log(s);const N=l.current;if(b!=null&&N!==null&&s!==void 0&&s!==null){a.preventDefault();const{width:r,height:d}=b.getBoundingClientRect(),h=_.current;h.startWidth=r,h.startHeight=d,h.ratio=r/d,h.currentWidth=r,h.currentHeight=d,h.startX=a.clientX,h.startY=a.clientY,h.direction=g,c(g),t.update(()=>{const I=n.$getNodeByKey(u);Y(I)&&console.log(I.__height)}),N.classList.add("image-control-wrapper--resizing"),s.style.width=`${100*r/C}%`,document.addEventListener("pointermove",$),document.addEventListener("pointerup",M)}},$=a=>{var R,f;const g=e.current,b=(f=(R=e.current)==null?void 0:R.parentElement)==null?void 0:f.parentElement,s=_.current,N=s.direction&(o.east|o.west),D=s.direction&(o.south|o.north);if(g!==null&&b!==void 0&&b!==null)if(N&&D){let r=Math.floor(s.startX-a.clientX);r=s.direction&o.east?-r:r;const d=k(s.startWidth+r,y,C),h=d/s.ratio;b.style.width=`${100*d/C}%`,w(100*d/C),s.currentHeight=h,s.currentWidth=d}else if(D){let r=Math.floor(s.startY-a.clientY);r=s.direction&o.south?-r:r;const d=k(s.startHeight+r,z,E);s.currentHeight=d}else{let r=Math.floor(s.startX-a.clientX);r=s.direction&o.east?-r:r;const d=k(s.startWidth+r,y,C);g.style.width=`${100*d/C}%`,s.currentWidth=d}},M=()=>{var s,N;const a=(N=(s=e.current)==null?void 0:s.parentElement)==null?void 0:N.parentElement,g=_.current,b=l.current;a!==null&&b!==null&&(g.startWidth=0,g.startHeight=0,g.ratio=0,g.startX=0,g.startY=0,g.currentWidth=0,g.currentHeight=0,b.classList.remove("image-control-wrapper--resizing"),P(),document.removeEventListener("pointermove",$),document.removeEventListener("pointerup",M))};return m.useEffect(()=>{const a=_.current,g=e.current;if(g!=null){const{width:b}=g.getBoundingClientRect();a.currentWidth=b,w(100*b/C)}},[C,e]),i.jsxs(je,{ref:l,className:"ImageResizer",style:{width:`${L}%`},children:[i.jsx("div",{className:"image-resizer image-resizer-n",onPointerDown:a=>{x(a,o.north)}}),i.jsx("div",{className:"image-resizer image-resizer-ne",onPointerDown:a=>{x(a,o.north|o.east)}}),i.jsx("div",{className:"image-resizer image-resizer-e",onPointerDown:a=>{x(a,o.east)}}),i.jsx("div",{className:"image-resizer image-resizer-se",onPointerDown:a=>{x(a,o.south|o.east)}}),i.jsx("div",{className:"image-resizer image-resizer-s",onPointerDown:a=>{x(a,o.south)}}),i.jsx("div",{className:"image-resizer image-resizer-sw",onPointerDown:a=>{x(a,o.south|o.west)}}),i.jsx("div",{className:"image-resizer image-resizer-w",onPointerDown:a=>{x(a,o.west)}}),i.jsx("div",{className:"image-resizer image-resizer-nw",onPointerDown:a=>{x(a,o.north|o.west)}})]})}const je=fe.div`
  cursor: default;
  .image-resizer {
    display: block;
    width: 7px;
    height: 7px;
    position: absolute;
    background-color: rgb(60, 132, 244);
    border: 1px solid #fff;
  }

  .image-resizer.image-resizer-n {
    top: -6px;
    left: 48%;
    cursor: n-resize;
  }

  .image-resizer.image-resizer-ne {
    top: -6px;
    right: -6px;
    cursor: ne-resize;
  }

  .image-resizer.image-resizer-e {
    bottom: 48%;
    right: -6px;
    cursor: e-resize;
  }

  .image-resizer.image-resizer-se {
    bottom: -2px;
    right: -6px;
    cursor: nwse-resize;
  }

  .image-resizer.image-resizer-s {
    bottom: -2px;
    left: 48%;
    cursor: s-resize;
  }

  .image-resizer.image-resizer-sw {
    bottom: -2px;
    left: -6px;
    cursor: sw-resize;
  }

  .image-resizer.image-resizer-w {
    bottom: 48%;
    left: -6px;
    cursor: w-resize;
  }

  .image-resizer.image-resizer-nw {
    top: -6px;
    left: -6px;
    cursor: nw-resize;
  }
`;function ke({children:e,className:t}){return i.jsx("div",{className:t||"Placeholder__root",children:e})}const J=new Set,V=n.createCommand("RIGHT_CLICK_IMAGE_COMMAND");function Ye(e){if(!J.has(e))throw new Promise(t=>{const u=new Image;u.src=e,u.onload=()=>{J.add(e),t(null)}})}function Be({altText:e,className:t,imageRef:u,src:l}){return Ye(l),i.jsx("img",{className:t||void 0,src:l,alt:e,ref:u,draggable:"false"})}function Fe({src:e,altText:t,nodeKey:u,width:l,resizable:v,showCaption:_,caption:L,captionsEnabled:w}){const p=m.useRef(null),C=m.useRef(null),[E,y,z]=de.useLexicalNodeSelection(u),[c]=T.useLexicalComposerContext(),[P,x]=m.useState(null),$=m.useRef(null),M=m.useCallback(f=>{if(E&&n.$isNodeSelection(n.$getSelection())){f.preventDefault();const d=n.$getNodeByKey(u);Y(d)&&d.remove()}return!1},[E,u]),a=m.useCallback(f=>{const r=n.$getSelection(),d=C.current;if(E&&n.$isNodeSelection(r)&&r.getNodes().length===1){if(_)return n.$setSelection(null),f.preventDefault(),L.focus(),!0;if(d!==null&&d!==document.activeElement)return f.preventDefault(),d.focus(),!0}return!1},[L,E,_]),g=m.useCallback(f=>$.current===L||C.current===f.target?(n.$setSelection(null),c.update(()=>{y(!0);const r=c.getRootElement();r!==null&&r.focus()}),!0):!1,[L,c,y]),b=m.useCallback(f=>{const r=f;return r.target===p.current?(r.shiftKey?y(!E):(z(),y(!0)),!0):!1},[E,y,z]),s=m.useCallback(f=>{c.getEditorState().read(()=>{const r=n.$getSelection();f.target.tagName==="IMG"&&n.$isRangeSelection(r)&&r.getNodes().length===1&&c.dispatchCommand(V,f)})},[c]);m.useEffect(()=>{let f=!0;const r=c.getRootElement(),d=B.mergeRegister(c.registerUpdateListener(({editorState:h})=>{f&&x(h.read(()=>n.$getSelection()))}),c.registerCommand(n.SELECTION_CHANGE_COMMAND,(h,I)=>($.current=I,!1),n.COMMAND_PRIORITY_LOW),c.registerCommand(n.CLICK_COMMAND,b,n.COMMAND_PRIORITY_LOW),c.registerCommand(V,b,n.COMMAND_PRIORITY_LOW),c.registerCommand(n.DRAGSTART_COMMAND,h=>h.target===p.current?(h.preventDefault(),!0):!1,n.COMMAND_PRIORITY_LOW),c.registerCommand(n.KEY_DELETE_COMMAND,M,n.COMMAND_PRIORITY_LOW),c.registerCommand(n.KEY_BACKSPACE_COMMAND,M,n.COMMAND_PRIORITY_LOW),c.registerCommand(n.KEY_ENTER_COMMAND,a,n.COMMAND_PRIORITY_LOW),c.registerCommand(n.KEY_ESCAPE_COMMAND,g,n.COMMAND_PRIORITY_LOW));return r==null||r.addEventListener("contextmenu",s),()=>{f=!1,d(),r==null||r.removeEventListener("contextmenu",s)}},[z,c,E,u,M,a,g,b,s,y]);const N=()=>{c.update(()=>{const f=n.$getNodeByKey(u);Y(f)&&f.setShowCaption(!0)})},D=E&&n.$isNodeSelection(P),R=E;return i.jsx(m.Suspense,{fallback:null,children:i.jsxs(i.Fragment,{children:[i.jsx("div",{draggable:D,children:i.jsx(Be,{className:R?`focused ${n.$isNodeSelection(P)?"draggable":""}`:null,src:e,altText:t,imageRef:p,width:l})}),_&&i.jsx("div",{className:"image-caption-container",children:i.jsxs(He.LexicalNestedComposer,{initialEditor:L,children:[i.jsx(le.AutoFocusPlugin,{}),i.jsx($e.HashtagPlugin,{}),i.jsx(be.RichTextPlugin,{contentEditable:i.jsx(Ae,{className:"ImageNode__contentEditable"}),placeholder:i.jsx(ke,{className:"ImageNode__placeholder",children:"Enter a caption..."}),ErrorBoundary:ge})]})}),v&&n.$isNodeSelection(P)&&R&&i.jsx(We,{showCaption:_,setShowCaption:N,editor:c,buttonRef:C,imageRef:p,nodeKey:u,captionsEnabled:w})]})})}export{V as RIGHT_CLICK_IMAGE_COMMAND,Fe as default};
